# Flyway with Spring Boot
# Flyway
Flyway是个非常简单的工具，他帮我们解决了每次项目重新构建时候，已经执行的sql脚本不需要重复执行的问题。  
例如schema.sql可以创建表结构，但是当我们重启项目的时候，不要再次执行这个脚本，甚至重复执行会报错，导致应用不能正常启动。
# 工作原理
原理非常简单，在SpringBoot应用中可以直接自动装配，并识别resources/db/migration目录。该目录下放置需要执行的sql脚本即可，命名方式为
```
Vx__filename.sql
```
**注意这里有两个下划线**，x是版本号不能重复，实际情况下x可以是`1_1`这种有子版本的写法，版本号不能重复，即不能有两个文件的前缀一样。  
项目启动在注入的DataSource上顺序执行这几个版本的sql文件，如果再次启动则不会执行已经执行的sql。  
原理是第一次启动后，sql文件复制到了`target/classes/db/migration`下了，再次启动这个目录下文件没变化则不执行，如果新加了一个V4版本的sql，编译的时候则会添加过来，并将其运行。  
所以如果需要重新全部运行所有的sql，则`mvn clean`或者直接将target目录删掉，在运行就行了。



